# 训练模型使用说明

## 数据集路径

已配置的数据集路径：
```
C:\Users\33106\Desktop\每个类别提供5张的部分数据集\每个类别提供5张的部分数据集
```

## 运行训练

### 方法 1：直接运行（推荐）

在项目根目录下运行：

```bash
python 1.py
```

或者：

```bash
py 1.py
```

### 方法 2：使用自定义参数

```bash
python 1.py --data "C:\Users\33106\Desktop\每个类别提供5张的部分数据集\每个类别提供5张的部分数据集" --epochs 50 --batch 16
```

## 训练参数

- **EPOCHS**: 50（训练轮数）
- **BATCH_SIZE**: 16（批次大小）
- **LR**: 2e-4（学习率）
- **EARLY_STOP**: 8（早停轮数）
- **IMG_SIZE**: 224（图像尺寸）

## 输出文件

训练完成后会生成：

1. **best_model_custom.pth** - 最佳模型权重
2. **server/assets/label_map.json** - 类别映射文件（自动生成）

## 使用训练好的模型

训练完成后，在 `.env` 文件中配置：

```env
MODEL_PATH=best_model_custom.pth
MODEL_BACKBONE=efficientnet_b0
DEVICE=cuda
```

## 数据集结构要求

数据集目录结构应为：

```
每个类别提供5张的部分数据集/
├── 类别1/
│   ├── 图片1.jpg
│   ├── 图片2.jpg
│   └── ...
├── 类别2/
│   ├── 图片1.jpg
│   └── ...
└── ...
```

脚本会自动按 8:1:1 划分训练集、验证集和测试集。

## 注意事项

1. 确保数据集路径正确
2. 每个类别至少需要几张图片（建议至少 5 张）
3. 训练时间取决于数据集大小和硬件配置
4. 如果有 GPU，训练会更快

## 查看训练结果

训练过程中会输出：
- 每个 epoch 的训练和验证准确率
- 最终测试集准确率
- 分类报告和混淆矩阵

训练完成后，模型会自动保存，类别映射也会自动更新到系统中。

